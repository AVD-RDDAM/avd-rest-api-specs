# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-rest-api-specs/main/documentation/api-scenario/references/v1.2/schema.json
scope: ResourceGroup

variables:
  location: 
    type: string
    value: eastus
  adminPassword:
    type: secureString
  autoscaleSettingName:
    type: string
    prefix: autoscalesettingna

prepareSteps:
  - step: NetworkAndSubnet_Create
    armTemplate: templates/Create_NetworkAndSubnet.json
  - step: NetworkInterface_Create
    armTemplate: templates/Create_NetworkInterface.json
  - step: VMSS_Create
    armTemplate: templates/Create_VMSS.json

scenarios:
  - scenario: AutoscaleSettings
    description: Microsoft.Insights/autoscalesettings
    steps:
      - step: AutoscaleSettings_Create
        exampleFile: ../examples/createOrUpdateAutoscaleSetting.json
        requestUpdate:
          - replace: /parameters/properties/targetResourceUri
            value: $(vmssId)
          - remove: /parameters/properties/notifications/0/webhooks
          - remove: /parameters/properties/profiles/0/rules
          - remove: /parameters/properties/profiles/1
      - step: AutoscaleSettings_Update
        exampleFile: ../examples/patchAutoscaleSetting.json
        requestUpdate:
          - remove: /autoscaleSettingResource/properties
      - step: AutoscaleSettings_ListBySubscription
        exampleFile: ../examples/listAutoscaleSettingBySubscription.json
      - step: AutoscaleSettings_ListByResourceGroup
        exampleFile: ../examples/listAutoscaleSetting.json
      - step: AutoscaleSettings_Get
        exampleFile: ../examples/getAutoscaleSetting.json
      - step: AutoscaleSettings_Delete
        exampleFile: ../examples/deleteAutoscaleSetting.json

  - scenario: EventCategories
    description: Microsoft.Insights/eventcategories
    steps:
      - step: EventCategories_List
        exampleFile: ../examples/GetEventCategories.json

  - scenario: Operations
    description: Microsoft.Insights/operations
    steps:
      - step: Operations_List
        exampleFile: ../examples/OperationList.json